<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"[]>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Intro to Rx - Leaving the monad</title>
    <link href="../../Styles/Site.css" rel="stylesheet" type="text/css" />
    <!--Google analytics-->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-32704657-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </head>
  <body>
    <div class="page">
      <div class="header">
        <div style="margin: 70px 20px 5px; float: right;text-align: right">
          <a href="http://twitter.com/#!/search/%23RxNET">#RxNET</a>
          <br />
          <span style="color: #707070; font-weight: 700; font-size: 11px;">Version v1.0.1062.0</span>
        </div>
        <img id="Logo" src="../../Styles/titleText.png" style="height: 80px; margin: 20px; float: left" />
        <table class="toc" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <th class="toc">
              <a class="toc" href="00_Foreword.html">Preface</a>
            </th>
            <th class="toc">
              <a class="toc" href="01_WhyRx.html">PART 1</a>
            </th>
            <th class="toc">
              <a class="toc" href="04_CreatingObservableSequences.html">PART 2</a>
            </th>
            <th class="tocactive">PART 3</th>
            <th class="toc">
              <a class="toc" href="15_SchedulingAndThreading.html">PART 4</a>
            </th>
            <th class="toc">
              <a class="toc" href="18_UsageGuidelines.html">Appendix</a>
            </th>
          </tr>
          <tr>
            <td></td>
            <td class="toc">
              <a class="toc" href="01_WhyRx.html">Getting started</a>
            </td>
            <td class="toc">
              <a class="toc" href="04_CreatingObservableSequences.html">Sequence basics</a>
            </td>
            <td class="tocactive">Taming the sequence</td>
            <td class="toc">
              <a class="toc" href="15_SchedulingAndThreading.html">Concurrency</a>
            </td>
            <td></td>
          </tr>
        </table>
      </div>
      <div class="leftCol">
        <ul class="partMenu">
          <li>
            <div class="partMenuHeader">
              <a href="00_Foreword.html">Preface</a>
            </div>
            <ul>
              <li>
                <a href="00_Foreword.html#Acknowledgements">Acknowledgements</a>
              </li>
            </ul>
          </li>
        </ul>
        <ul class="partMenu">
          <li>
            <div class="partMenuHeader">
              <a href="01_WhyRx.html">PART 1 - Getting started</a>
            </div>
            <ul>
              <li>
                <a href="01_WhyRx.html#WhyRx">Why Rx?</a>
              </li>
              <li>
                <a href="02_KeyTypes.html#KeyTypes">Key types</a>
              </li>
              <li>
                <a href="03_LifetimeManagement.html#LifetimeManagement">Lifetime management</a>
              </li>
            </ul>
          </li>
        </ul>
        <ul class="partMenu">
          <li>
            <div class="partMenuHeader">
              <a href="04_CreatingObservableSequences.html">PART 2 - Sequence basics</a>
            </div>
            <ul>
              <li>
                <a href="04_CreatingObservableSequences.html#CreationOfObservables">Creating a sequence</a>
              </li>
              <li>
                <a href="05_Filtering.html#Reduction">Reducing a sequence</a>
              </li>
              <li>
                <a href="06_Inspection.html#Inspection">Inspection</a>
              </li>
              <li>
                <a href="07_Aggregation.html#Aggregation">Aggregation</a>
              </li>
              <li>
                <a href="08_Transformation.html#TransformationOfSequences">Transformation of sequences</a>
              </li>
            </ul>
          </li>
        </ul>
        <ul class="partMenu">
          <li>
            <div class="partMenuHeader">
              <a href="09_SideEffects.html">PART 3 - Taming the sequence</a>
            </div>
            <ul>
              <li>
                <a href="09_SideEffects.html#SideEffects">Side effects</a>
                <ul>
                  <li>
                    <a href="09_SideEffects.html#IssuesWithSideEffects">Issues with side effects</a>
                  </li>
                  <li>
                    <a href="09_SideEffects.html#ComposingDataInAPipeline">Composing data in a pipeline</a>
                  </li>
                  <li>
                    <a href="09_SideEffects.html#Do">Do</a>
                  </li>
                  <li>
                    <a href="09_SideEffects.html#AsObservable">Encapsulating with AsObservable</a>
                  </li>
                  <li>
                    <a href="09_SideEffects.html#MutableElementsCantBeProtected">Mutable elements cannot be protected</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="10_LeavingTheMonad.html#LeavingTheMonad">Leaving the monad</a>
                <ul>
                  <li>
                    <a href="10_LeavingTheMonad.html#WhatIsAMonad">What is a monad</a>
                  </li>
                  <li>
                    <a href="10_LeavingTheMonad.html#WhyLeaveTheMonad">Why leave the monad?</a>
                  </li>
                  <li>
                    <a href="10_LeavingTheMonad.html#ForEach">ForEach</a>
                  </li>
                  <li>
                    <a href="10_LeavingTheMonad.html#ToEnumerable">ToEnumerable</a>
                  </li>
                  <li>
                    <a href="10_LeavingTheMonad.html#ToBatch">To a single collection</a>
                    <ul>
                      <li>
                        <a href="10_LeavingTheMonad.html#ToArrayAndToList">ToArray and ToList</a>
                      </li>
                      <li>
                        <a href="10_LeavingTheMonad.html#ToDictionaryAndToLookup">ToDictionary and ToLookup</a>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <a href="10_LeavingTheMonad.html#ToTask">ToTask</a>
                  </li>
                  <li>
                    <a href="10_LeavingTheMonad.html#ToEventT">ToEvent&lt;T&gt;</a>
                    <ul>
                      <li>
                        <a href="10_LeavingTheMonad.html#ToEventPattern">ToEventPattern</a>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li>
                <a href="11_AdvancedErrorHandling.html#AdvancedErrorHandling">Advanced error handling</a>
                <ul>
                  <li>
                    <a href="11_AdvancedErrorHandling.html#ControlFlowConstructs">Control flow constructs</a>
                    <ul>
                      <li>
                        <a href="11_AdvancedErrorHandling.html#Catch">Catch</a>
                        <ul>
                          <li>
                            <a href="11_AdvancedErrorHandling.html#CatchSwallowingException">Swallowing exceptions</a>
                          </li>
                        </ul>
                      </li>
                      <li>
                        <a href="11_AdvancedErrorHandling.html#Finally">Finally</a>
                      </li>
                      <li>
                        <a href="11_AdvancedErrorHandling.html#Using">Using</a>
                      </li>
                      <li>
                        <a href="11_AdvancedErrorHandling.html#OnErrorResumeNext">OnErrorResumeNext</a>
                      </li>
                      <li>
                        <a href="11_AdvancedErrorHandling.html#Retry">Retry</a>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li>
                <a href="12_CombiningSequences.html#CombiningMultipleSequences">Combining sequences</a>
                <ul>
                  <li>
                    <a href="12_CombiningSequences.html#SimpleConcatenation">Sequential concatenation</a>
                    <ul>
                      <li>
                        <a href="12_CombiningSequences.html#Concat">Concat</a>
                      </li>
                      <li>
                        <a href="12_CombiningSequences.html#Repeat">Repeat</a>
                      </li>
                      <li>
                        <a href="12_CombiningSequences.html#StartWith">StartWith</a>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <a href="12_CombiningSequences.html#ConcurrentSequences">Concurrent sequences</a>
                    <ul>
                      <li>
                        <a href="12_CombiningSequences.html#Amb">Amb</a>
                      </li>
                      <li>
                        <a href="12_CombiningSequences.html#Merge">Merge</a>
                      </li>
                      <li>
                        <a href="12_CombiningSequences.html#Switch">Switch</a>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <a href="12_CombiningSequences.html#ParingSequences">Pairing sequences</a>
                    <ul>
                      <li>
                        <a href="12_CombiningSequences.html#CombineLatest">CombineLatest</a>
                      </li>
                      <li>
                        <a href="12_CombiningSequences.html#Zip">Zip</a>
                      </li>
                      <li>
                        <a href="12_CombiningSequences.html#AndThenWhen">And-Then-When</a>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li>
                <a href="13_TimeShiftedSequences.html#TimeShiftedSequences">Time-shifted sequences</a>
                <ul>
                  <li>
                    <a href="13_TimeShiftedSequences.html#Buffer">Buffer</a>
                    <ul>
                      <li>
                        <a href="13_TimeShiftedSequences.html#OverlappingBuffers">Overlapping buffers</a>
                        <ul>
                          <li>
                            <a href="13_TimeShiftedSequences.html#OverlappingBuffersByCount">Overlapping buffers by count</a>
                          </li>
                          <li>
                            <a href="13_TimeShiftedSequences.html#OverlappingBuffersByTime">Overlapping buffers by time</a>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <a href="13_TimeShiftedSequences.html#Delay">Delay</a>
                  </li>
                  <li>
                    <a href="13_TimeShiftedSequences.html#Sample">Sample</a>
                  </li>
                  <li>
                    <a href="13_TimeShiftedSequences.html#Throttle">Throttle</a>
                  </li>
                  <li>
                    <a href="13_TimeShiftedSequences.html#Timeout">Timeout</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="14_HotAndColdObservables.html#HotAndCold">Hot and Cold observables</a>
                <ul>
                  <li>
                    <a href="14_HotAndColdObservables.html#ColdObservables">Cold observables</a>
                  </li>
                  <li>
                    <a href="14_HotAndColdObservables.html#HotObservables">Hot observables</a>
                  </li>
                  <li>
                    <a href="14_HotAndColdObservables.html#PublishAndConnect">Publish and Connect</a>
                    <ul>
                      <li>
                        <a href="14_HotAndColdObservables.html#Disposal">Disposal of connections and subscriptions</a>
                      </li>
                      <li>
                        <a href="14_HotAndColdObservables.html#RefCount">RefCount</a>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <a href="14_HotAndColdObservables.html#OtherConnectables">Other connectable observables</a>
                    <ul>
                      <li>
                        <a href="14_HotAndColdObservables.html#PublishLast">PublishLast</a>
                      </li>
                      <li>
                        <a href="14_HotAndColdObservables.html#Replay">Replay</a>
                      </li>
                      <li>
                        <a href="14_HotAndColdObservables.html#Multicast">Multicast</a>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
        <ul class="partMenu">
          <li>
            <div class="partMenuHeader">
              <a href="15_SchedulingAndThreading.html">PART 4 - Concurrency</a>
            </div>
            <ul>
              <li>
                <a href="15_SchedulingAndThreading.html#SchedulingAndThreading">Scheduling and threading</a>
              </li>
              <li>
                <a href="16_TestingRx.html#TestingRx">Testing Rx</a>
              </li>
              <li>
                <a href="17_SequencesOfCoincidence.html#SequencesOfCoincidence">Sequences of coincidence</a>
              </li>
              <li>
                <a href="17_SequencesOfCoincidence.html#Summary">Summary</a>
              </li>
            </ul>
          </li>
        </ul>
        <ul class="partMenu">
          <li>
            <div class="partMenuHeader">
              <a href="18_UsageGuidelines.html">Appendix</a>
            </div>
            <ul>
              <li>
                <a href="18_UsageGuidelines.html#UsageGuidelines">Usage guidelines</a>
              </li>
              <li>
                <a href="19_DispellingMyths.html#DispellingEventMyths">Dispelling event myths</a>
              </li>
              <li>
                <a href="20_Disposables.html#Disposables">Disposables</a>
              </li>
            </ul>
          </li>
        </ul>
      </div>
      <div class="main">
        <div style="float: right; margin: 10px 0px 10px 10px; width: 140px; font-size: 11px;text-align: center">
          <img src="../../Styles/IntroToRx_Cover.png" style="margin: 10px" />
                                            Lee Campbell<br /><a href="IntroToRx.mobi" title="Introduction to Rx as .mobi file (for Kindle)">Introduction to Rx<br />Kindle edition</a> (2012)
                                        </div>
        <a name="LeavingTheMonad"></a>
        <h1>Leaving the monad</h1>
        <p>
        An observable sequence is a useful construct, especially when we have the power
        of LINQ to compose complex queries over it. Even though we recognize the benefits
        of the observable sequence, sometimes it is required to leave the <em>IObservable&lt;T&gt;</em>
        paradigm for another paradigm, maybe to enable you to integrate with an existing API
        (i.e. use events or <em>Task&lt;T&gt;</em>). You might leave the observable paradigm
        if you find it easier for testing, or it may simply be easier for you to learn Rx
        by moving between an observable paradigm and a more familiar one.
    </p>
        <a name="WhatIsAMonad"></a>
        <h2>What is a monad</h2>
        <p>
        We have casually referred to the term <i>monad</i> earlier in the book, but to most
        it will be a very foreign term. I am going to try to avoid overcomplicating what
        a monad is, but give enough of an explanation to help us out with our next category
        of methods. The full definition of a monad is quite abstract. <a href="http://www.haskell.org/haskellwiki/Monad_tutorials_timeline">
            Many others</a> have tried to provide their definition of a monad using all
        sorts of metaphors from astronauts to Alice in Wonderland. Many of the tutorials
        for monadic programming use Haskell for the code examples which can add to the confusion.
        For us, a monad is effectively a programming structure that represents computations.
        Compare this to other programming structures:
    </p>
        <dl>
          <dt>Data structure</dt>
          <dd>
            Purely state e.g. a List, a Tree or a Tuple
        </dd>
          <dt>Contract</dt>
          <dd>
            Contract definition or abstract functionality e.g. an interface or abstract class
        </dd>
          <dt>Object-Orientated structure</dt>
          <dd>
            State and behavior together
        </dd>
        </dl>
        <p>
        Generally a monadic structure allows you to chain together operators to produce
        a pipeline, just as we do with our extension methods.
    </p>
        <cite>Monads are a kind of abstract data type constructor that encapsulate program logic
        instead of data in the domain model. </cite>
        <p>
        This neat definition of a monad lifted from Wikipedia allows us to start viewing
        sequences as monads; the abstract data type in this case is the <em>IObservable&lt;T&gt;</em>
        type. When we use an observable sequence, we compose functions onto the abstract
        data type (the <em>IObservable&lt;T&gt;</em>) to create a query. This query becomes
        our encapsulated programming logic.
    </p>
        <p>
        The use of monads to define control flows is particularly useful when dealing with
        typically troublesome areas of programming such as IO, concurrency and exceptions.
        This just happens to be some of Rx's strong points!
    </p>
        <a name="WhyLeaveTheMonad"></a>
        <h2>Why leave the monad?</h2>
        <p>
        There is a variety of reasons you may want to consume an observable sequence in
        a different paradigm. Libraries that need to expose functionality externally may
        be required to present it as events or as <em>Task</em> instances. In demonstration and sample
        code you may prefer to use blocking methods to limit the number of asynchronous
        moving parts. This may help make the learning curve to Rx a little less steep!
    </p>
        <p>
        In production code, it is rarely advised to 'break the monad', especially moving
        from an observable sequence to blocking methods. Switching between asynchronous
        and synchronous paradigms should be done with caution, as this is a common root
        cause for concurrency problems such as deadlock and scalability issues.
    </p>
        <p>
        In this chapter, we will look at the methods in Rx which allow you to leave the
        <em>IObservable&lt;T&gt;</em> monad.
    </p>
        <a name="ForEach"></a>
        <h2>ForEach</h2>
        <p>
        The <em>ForEach</em> method provides a way to process elements as they are received.
        The key difference between <em>ForEach</em> and <em>Subscribe</em> is that <em>ForEach</em>
        will block the current thread until the sequence completes.
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">var</span> source = <span class="knownType">Observable</span>.Interval(<span class="knownType">TimeSpan</span>.FromSeconds(1))</div>
<div class="scope">
    <div class="line">.Take(5);</div>
</div>
<div class="line">source.ForEach(i =&gt; <span class="knownType">Console</span>.WriteLine(<span class="str">"received {0} @ {1}"</span>, i, DateTime.Now));</div>
<div class="line"><span class="knownType">Console</span>.WriteLine(<span class="str">"completed @ {0}"</span>, DateTime.Now);</div>
</div>
        <p>
        Output:
    </p>
        <div class="output">
          <div class="line">received 0 @ 01/01/2012 12:00:01 a.m.</div>
          <div class="line">received 1 @ 01/01/2012 12:00:02 a.m.</div>
          <div class="line">received 2 @ 01/01/2012 12:00:03 a.m.</div>
          <div class="line">received 3 @ 01/01/2012 12:00:04 a.m.</div>
          <div class="line">received 4 @ 01/01/2012 12:00:05 a.m.</div>
          <div class="line">completed @ 01/01/2012 12:00:05 a.m.</div>
        </div>
        <p>
        Note that the completed line is last, as you would expect. To be clear, you can
        get similar functionality from the <em>Subscribe</em> extension method, but the
        <em>Subscribe</em> method will not block. So if we substitute the call to <em>ForEach</em>
        with a call to <em>Subscribe</em>, we will see the completed line happen first.
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">var</span> source = <span class="knownType">Observable</span>.Interval(<span class="knownType">TimeSpan</span>.FromSeconds(1))</div>
<div class="scope">
    <div class="line">.Take(5);</div>
</div>
<div class="line">source.Subscribe(i =&gt; <span class="knownType">Console</span>.WriteLine(<span class="str">"received {0} @ {1}"</span>, i, DateTime.Now));</div>
<div class="line"><span class="knownType">Console</span>.WriteLine(<span class="str">"completed @ {0}"</span>, DateTime.Now);</div>
</div>
        <p>
        Output:
    </p>
        <div class="output">
          <div class="line">completed @ 01/01/2012 12:00:00 a.m.</div>
          <div class="line">received 0 @ 01/01/2012 12:00:01 a.m.</div>
          <div class="line">received 1 @ 01/01/2012 12:00:02 a.m.</div>
          <div class="line">received 2 @ 01/01/2012 12:00:03 a.m.</div>
          <div class="line">received 3 @ 01/01/2012 12:00:04 a.m.</div>
          <div class="line">received 4 @ 01/01/2012 12:00:05 a.m.</div>
        </div>
        <p>
        Unlike the <em>Subscribe</em> extension method, <em>ForEach</em> has only the one
        overload; the one that take an <em>Action&lt;T&gt;</em> as its single argument.
        In contrast, previous (pre-release) versions of Rx, the <em>ForEach</em> method
        had most of the same overloads as <em>Subscribe</em>. Those overloads of <em>ForEach</em>
        have been deprecated, and I think rightly so. There is no need to have an <code>OnCompleted</code>
        handler in a synchronous call, it is unnecessary. You can just place the call immediately
        after the <em>ForEach</em> call as we have done above. Also, the <code>OnError</code>
        handler can now be replaced with standard Structured Exception Handling like you
        would use for any other synchronous code, with a <code>try</code>/<code>catch</code>
        block. This also gives symmetry to the <em>ForEach</em> instance method on the <em>List&lt;T&gt;</em>
        type.
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">var</span> source = <span class="knownType">Observable</span>.Throw&lt;<span class="kwrd">int</span>&gt;(<span class="kwrd">new</span> <span class="knownType">Exception</span>(<span class="str">"Fail"</span>));</div>
<div class="line"><span class="kwrd">try</span></div>
<div class="line">{</div>
<div class="scope">
    <div class="line">source.ForEach(<span class="knownType">Console</span>.WriteLine);</div>
</div>
<div class="line">}</div>
<div class="line"><span class="kwrd">catch</span> (<span class="knownType">Exception</span> ex)</div>
<div class="line">{</div>
<div class="scope">
    <div class="line"><span class="knownType">Console</span>.WriteLine(<span class="str">"error @ {0} with {1}"</span>, DateTime.Now, ex.Message);</div>
</div>
<div class="line">}</div>
<div class="line"><span class="kwrd">finally</span></div>
<div class="line">{</div>
<div class="scope">
    <div class="line"><span class="knownType">Console</span>.WriteLine(<span class="str">"completed @ {0}"</span>, DateTime.Now);    </div>
</div>
<div class="line">}</div>
</div>
        <p>
        Output:
    </p>
        <div class="output">
          <div class="line">error @ 01/01/2012 12:00:00 a.m. with Fail</div>
          <div class="line">completed @ 01/01/2012 12:00:00 a.m.</div>
        </div>
        <p>
        The <em>ForEach</em> method, like its other blocking friends (<em>First</em> and
        <em>Last</em> etc.), should be used with care. I would leave the <em>ForEach</em>
        method for spikes, tests and demo code only. We will discuss the problems with introducing
        blocking calls when we look at concurrency.
    </p>
        <a name="ToEnumerable"></a>
        <h2>ToEnumerable</h2>
        <p>
        An alternative way to switch out of the <em>IObservable&lt;T&gt;</em> is to call
        the <em>ToEnumerable</em> extension method. As a simple example:
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">var</span> period = <span class="knownType">TimeSpan</span>.FromMilliseconds(200);</div>
<div class="line"><span class="kwrd">var</span> source = <span class="knownType">Observable</span>.<span class="knownType">Timer</span>(<span class="knownType">TimeSpan</span>.Zero, period) </div>
<div class="scope">
    <div class="line">.Take(5); </div>
</div>
<div class="line"><span class="kwrd">var</span> result = source.ToEnumerable();</div>
<div class="line"><span class="kwrd">foreach</span> (<span class="kwrd">var</span> value <span class="kwrd">in</span> result) </div>
<div class="line">{ </div>
<div class="scope">
    <div class="line"><span class="knownType">Console</span>.WriteLine(value); </div>
</div>
<div class="line">} </div>
<div class="line"><span class="knownType">Console</span>.WriteLine(<span class="str">"done"</span>);</div>
</div>
        <p>
        Output:
    </p>
        <div class="output">
          <div class="line">0</div>
          <div class="line">1</div>
          <div class="line">2</div>
          <div class="line">3</div>
          <div class="line">4</div>
          <div class="line">done</div>
        </div>
        <p>
        The source observable sequence will be subscribed to when you start to enumerate
        the sequence (i.e. lazily). In contrast to the <em>ForEach</em> extension method,
        using the <em>ToEnumerable</em> method means you are only blocked when you try to
        move to the next element and it is not available. Also, if the sequence produces
        values faster than you consume them, they will be cached for you.
    </p>
        <p>
        To cater for errors, you can wrap your <code>foreach</code> loop in a <code>try</code>/<code>catch</code>
        as you do with any other enumerable sequence:
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">try</span> </div>
<div class="line">{ </div>
<div class="scope">
    <div class="line"><span class="kwrd">foreach</span> (<span class="kwrd">var</span> value <span class="kwrd">in</span> result)</div>
    <div class="line">{ </div>
    <div class="scope">
        <div class="line"><span class="knownType">Console</span>.WriteLine(value); </div>
    </div>
    <div class="line">} </div>
</div>
<div class="line">} </div>
<div class="line"><span class="kwrd">catch</span> (<span class="knownType">Exception</span> e) </div>
<div class="line">{ </div>
<div class="scope">
    <div class="line"><span class="knownType">Console</span>.WriteLine(e.Message);</div>
</div>
<div class="line">} </div>
</div>
        <p>
        As you are moving from a push to a pull model (non-blocking to blocking), the standard
        warning applies.
    </p>
        <a name="ToBatch"></a>
        <h2>To a single collection</h2>
        <p>
        To avoid having to oscillate between push and pull, you can use one of the
        next four methods to get the entire list back in a single notification. They all
        have the same semantics, but just produce the data in a different format. They are
        similar to their corresponding <em>IEnumerable&lt;T&gt;</em> operators, but the
        return values differ in order to retain asynchronous behavior.
    </p>
        <a name="ToArrayAndToList"></a>
        <h3>ToArray and ToList</h3>
        <p>
        Both <em>ToArray</em> and <em>ToList</em> take an observable sequence and package
        it into an array or an instance of <em>List&lt;T&gt;</em> respectively. Once the
        observable sequence completes, the array or list will be pushed as the single value
        of the result sequence.
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">var</span> period = <span class="knownType">TimeSpan</span>.FromMilliseconds(200); </div>
<div class="line"><span class="kwrd">var</span> source = <span class="knownType">Observable</span>.<span class="knownType">Timer</span>(<span class="knownType">TimeSpan</span>.Zero, period).Take(5); </div>
<div class="line"><span class="kwrd">var</span> result = source.ToArray(); </div>
<div class="line">result.Subscribe( </div>
<div class="scope">
    <div class="line">arr =&gt; { </div>
    <div class="scope">
        <div class="line"><span class="knownType">Console</span>.WriteLine(<span class="str">"Received array"</span>); </div>
        <div class="line"><span class="kwrd">foreach</span> (<span class="kwrd">var</span> value <span class="kwrd">in</span> arr) </div>
        <div class="line">{ </div>
        <div class="scope">
            <div class="line"><span class="knownType">Console</span>.WriteLine(value); </div>
        </div>
        <div class="line">} </div>
    </div>
    <div class="line">}, </div>
    <div class="line">() =&gt; <span class="knownType">Console</span>.WriteLine(<span class="str">"Completed"</span>)</div>
</div>
<div class="line">); </div>
<div class="line"><span class="knownType">Console</span>.WriteLine(<span class="str">"Subscribed"</span>); </div>
</div>
        <p>
        Output:
    </p>
        <div class="output">
          <div class="line">Subscribed</div>
          <div class="line">Received array</div>
          <div class="line">0</div>
          <div class="line">1</div>
          <div class="line">2</div>
          <div class="line">3</div>
          <div class="line">4</div>
          <div class="line">Completed</div>
        </div>
        <p>
        As these methods still return observable sequences we can use our <code>OnError</code>
        handler for errors. Note that the source sequence is packaged to a single notification;
        you either get the whole sequence <b>or</b> the error. If the source produces values
        and then errors, you will not receive any of those values. All four operators (<em>ToArray</em>,
        <em>ToList</em>, <em>ToDictionary</em> and <em>ToLookup</em>) handle errors like
        this.
    </p>
        <a name="ToDictionaryAndToLookup"></a>
        <h3>ToDictionary and ToLookup</h3>
        <p>
        As an alternative to arrays and lists, Rx can package an observable sequence into
        a dictionary or lookup with the <em>ToDictionary</em> and <em>ToLookup</em> methods.
        Both methods have the same semantics as the <em>ToArray</em> and <em>ToList</em>
        methods, as they return a sequence with a single value and have the same error handling
        features.
    </p>
        <p>
        The <em>ToDictionary</em> extension method overloads:
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="rem">// Creates a dictionary from an observable sequence according to a specified key selector </span></div>
<div class="line"><span class="rem">// function, a comparer, and an element selector function.</span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">IObservable</span>&lt;<span class="knownType">IDictionary</span>&lt;TKey, TElement&gt;&gt; ToDictionary&lt;TSource, TKey, TElement&gt;(</div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;TSource&gt; source, </div>
    <div class="line"><span class="knownType">Func</span>&lt;TSource, TKey&gt; keySelector, </div>
    <div class="line"><span class="knownType">Func</span>&lt;TSource, TElement&gt; elementSelector, </div>
    <div class="line"><span class="knownType">IEqualityComparer</span>&lt;TKey&gt; comparer) </div>
</div>
<div class="line">{...} </div>
<div class="line"><span class="rem">// Creates a dictionary from an observable sequence according to a specified key selector </span></div>
<div class="line"><span class="rem">// function, and an element selector function. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">IObservable</span>&lt;<span class="knownType">IDictionary</span>&lt;TKey, TElement&gt;&gt; ToDictionary&lt;TSource, TKey, TElement&gt;( </div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;TSource&gt; source, </div>
    <div class="line"><span class="knownType">Func</span>&lt;TSource, TKey&gt; keySelector, </div>
    <div class="line"><span class="knownType">Func</span>&lt;TSource, TElement&gt; elementSelector) </div>
</div>
<div class="line">{...} </div>
<div class="line"><span class="rem">// Creates a dictionary from an observable sequence according to a specified key selector </span></div>
<div class="line"><span class="rem">// function, and a comparer. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">IObservable</span>&lt;<span class="knownType">IDictionary</span>&lt;TKey, TSource&gt;&gt; ToDictionary&lt;TSource, TKey&gt;( </div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;TSource&gt; source, </div>
    <div class="line"><span class="knownType">Func</span>&lt;TSource, TKey&gt; keySelector,</div>
    <div class="line"><span class="knownType">IEqualityComparer</span>&lt;TKey&gt; comparer) </div>
</div>
<div class="line">{...} </div>
<div class="line"><span class="rem">// Creates a dictionary from an observable sequence according to a specified key selector </span></div>
<div class="line"><span class="rem">// function. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">IObservable</span>&lt;<span class="knownType">IDictionary</span>&lt;TKey, TSource&gt;&gt; ToDictionary&lt;TSource, TKey&gt;( </div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;TSource&gt; source, </div>
    <div class="line"><span class="knownType">Func</span>&lt;TSource, TKey&gt; keySelector) </div>
</div>
<div class="line">{...} </div>
</div>
        <p>
        The <em>ToLookup</em> extension method overloads:
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="rem">// Creates a lookup from an observable sequence according to a specified key selector </span></div>
<div class="line"><span class="rem">// function, a comparer, and an element selector function. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">IObservable</span>&lt;<span class="knownType">ILookup</span>&lt;TKey, TElement&gt;&gt; ToLookup&lt;TSource, TKey, TElement&gt;( </div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;TSource&gt; source, </div>
    <div class="line"><span class="knownType">Func</span>&lt;TSource, TKey&gt; keySelector, </div>
    <div class="line"><span class="knownType">Func</span>&lt;TSource, TElement&gt; elementSelector,</div>
    <div class="line"><span class="knownType">IEqualityComparer</span>&lt;TKey&gt; comparer) </div>
</div>
<div class="line">{...} </div>
<div class="line"><span class="rem">// Creates a lookup from an observable sequence according to a specified key selector </span></div>
<div class="line"><span class="rem">// function, and a comparer. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">IObservable</span>&lt;<span class="knownType">ILookup</span>&lt;TKey, TSource&gt;&gt; ToLookup&lt;TSource, TKey&gt;(</div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;TSource&gt; source, </div>
    <div class="line"><span class="knownType">Func</span>&lt;TSource, TKey&gt; keySelector, </div>
    <div class="line"><span class="knownType">IEqualityComparer</span>&lt;TKey&gt; comparer) </div>
</div>
<div class="line">{...} </div>
<div class="line"><span class="rem">// Creates a lookup from an observable sequence according to a specified key selector </span></div>
<div class="line"><span class="rem">// function, and an element selector function. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">IObservable</span>&lt;<span class="knownType">ILookup</span>&lt;TKey, TElement&gt;&gt; ToLookup&lt;TSource, TKey, TElement&gt;( </div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;TSource&gt; source, </div>
    <div class="line"><span class="knownType">Func</span>&lt;TSource, TKey&gt; keySelector, </div>
    <div class="line"><span class="knownType">Func</span>&lt;TSource, TElement&gt; elementSelector)</div>
</div>
<div class="line">{...} </div>
<div class="line"><span class="rem">// Creates a lookup from an observable sequence according to a specified key selector </span></div>
<div class="line"><span class="rem">// function. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">IObservable</span>&lt;<span class="knownType">ILookup</span>&lt;TKey, TSource&gt;&gt; ToLookup&lt;TSource, TKey&gt;( </div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;TSource&gt; source, </div>
    <div class="line"><span class="knownType">Func</span>&lt;TSource,</div>
    <div class="line">TKey&gt; keySelector) </div>
</div>
<div class="line">{...} </div>
</div>
        <p>
        Both <em>ToDictionary</em> and <em>ToLookup</em> require a function that can be
        applied each value to get its key. In addition, the <em>ToDictionary</em> method
        overloads mandate that all keys should be unique. If a duplicate key is found, it
        terminate the sequence with a <em>DuplicateKeyException</em>. On the other hand,
        the <em>ILookup&lt;TKey, TElement&gt;</em> is designed to have multiple values grouped
        by the key. If you have many values per key, then <em>ToLookup</em> is probably
        the better option.
    </p>
        <a name="ToTask"></a>
        <h2>ToTask</h2>
        <p>
        We have compared <em>AsyncSubject&lt;T&gt;</em> to <em>Task&lt;T&gt;</em> and even
        showed how to <a href="04_CreatingObservableSequences.html#FromTask">transition from
            a task</a> to an observable sequence. The <em>ToTask</em> extension method will
        allow you to convert an observable sequence into a <em>Task&lt;T&gt;</em>. Like
        an <em>AsyncSubject&lt;T&gt;</em>, this method will ignore multiple values, only
        returning the last value.
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="rem">// Returns a task that contains the last value of the observable sequence. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">Task</span>&lt;TResult&gt; ToTask&lt;TResult&gt;(</div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;TResult&gt; observable) </div>
</div>
<div class="line">{...} </div>
<div class="line"><span class="rem">// Returns a task that contains the last value of the observable sequence, with state to </span></div>
<div class="line"><span class="rem">//  use as the underlying task's AsyncState. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">Task</span>&lt;TResult&gt; ToTask&lt;TResult&gt;(</div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;TResult&gt; observable,</div>
    <div class="line"><span class="kwrd">object</span> state) </div>
</div>
<div class="line">{...} </div>
<div class="line"><span class="rem">// Returns a task that contains the last value of the observable sequence. Requires a </span></div>
<div class="line"><span class="rem">//  cancellation token that can be used to cancel the task, causing unsubscription from </span></div>
<div class="line"><span class="rem">//  the observable sequence. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">Task</span>&lt;TResult&gt; ToTask&lt;TResult&gt;(</div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;TResult&gt; observable, </div>
    <div class="line"><span class="knownType">CancellationToken</span> cancellationToken) </div>
</div>
<div class="line">{...} </div>
<div class="line"><span class="rem">// Returns a task that contains the last value of the observable sequence, with state to </span></div>
<div class="line"><span class="rem">//  use as the underlying task's AsyncState. Requires a cancellation token that can be used</span></div>
<div class="line"><span class="rem">//  to cancel the task, causing unsubscription from the observable sequence. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">Task</span>&lt;TResult&gt; ToTask&lt;TResult&gt;(</div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;TResult&gt; observable, </div>
    <div class="line"><span class="knownType">CancellationToken</span> cancellationToken, </div>
    <div class="line"><span class="kwrd">object</span> state) </div>
</div>
<div class="line">{...} </div>
</div>
        <p>
        This is a simple example of how the <em>ToTask</em> operator can be used. Note,
        the <em>ToTask</em> method is in the <code>System.Reactive.Threading.Tasks</code>
        namespace.
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">var</span> source = <span class="knownType">Observable</span>.Interval(<span class="knownType">TimeSpan</span>.FromSeconds(1)) </div>
<div class="scope">
    <div class="line">.Take(5);</div>
</div>
<div class="line"><span class="kwrd">var</span> result = source.ToTask(); <span class="rem">//Will arrive in 5 seconds. </span></div>
<div class="line"><span class="knownType">Console</span>.WriteLine(result.Result);</div>
</div>
        <p>
        Output:
    </p>
        <div class="output">
          <div class="line">4</div>
        </div>
        <p>
        If the source sequence was to manifest error then the task would follow the error-handling
        semantics of tasks.
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">var</span> source = <span class="knownType">Observable</span>.Throw&lt;<span class="kwrd">long</span>&gt;(<span class="kwrd">new</span> <span class="knownType">Exception</span>(<span class="str">"Fail!"</span>)); </div>
<div class="line"><span class="kwrd">var</span> result = source.ToTask(); </div>
<div class="line"><span class="kwrd">try</span> </div>
<div class="line">{ </div>
<div class="scope">
    <div class="line"><span class="knownType">Console</span>.WriteLine(result.Result);</div>
</div>
<div class="line">} </div>
<div class="line"><span class="kwrd">catch</span> (AggregateException e) </div>
<div class="line">{ </div>
<div class="scope">
    <div class="line"><span class="knownType">Console</span>.WriteLine(e.InnerException.Message); </div>
</div>
<div class="line">}</div>
</div>
        <p>
        Output:
    </p>
        <div class="output">
          <div class="line">Fail!</div>
        </div>
        <p>
        Once you have your task, you can of course engage in all the features of the TPL
        such as continuations.
    </p>
        <a name="ToEventT"></a>
        <h2>ToEvent&lt;T&gt;</h2>
        <p>
        Just as you can use an event as the source for an observable sequence with <a href="04_CreatingObservableSequences.html#FromEvent"><em>FromEventPattern</em></a>, you can also make your observable sequence look
        like a standard .NET event with the <em>ToEvent</em> extension methods.
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="rem">// Exposes an observable sequence as an object with a .NET event. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">IEventSource</span>&lt;unit&gt; ToEvent(<span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;<span class="knownType">Unit</span>&gt; source)</div>
<div class="line">{...} </div>
<div class="line"><span class="rem">// Exposes an observable sequence as an object with a .NET event. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">IEventSource</span>&lt;TSource&gt; ToEvent&lt;TSource&gt;(</div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;TSource&gt; source) </div>
</div>
<div class="line">{...} </div>
<div class="line"><span class="rem">// Exposes an observable sequence as an object with a .NET event. </span></div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">static</span> <span class="knownType">IEventPatternSource</span>&lt;TEventArgs&gt; ToEventPattern&lt;TEventArgs&gt;(</div>
<div class="scope">
    <div class="line"><span class="kwrd">this</span> <span class="knownType">IObservable</span>&lt;<span class="knownType">EventPattern</span>&lt;TEventArgs&gt;&gt; source) </div>
    <div class="line">where TEventArgs : <span class="knownType">EventArgs</span> </div>
</div>
<div class="line">{...} </div>
</div>
        <p>
        The <em>ToEvent</em> method returns an <em>IEventSource&lt;T&gt;</em>, which will
        have a single event member on it: <code>OnNext</code>.
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">public</span> <span class="kwrd">interface</span> <span class="knownType">IEventSource</span>&lt;T&gt; </div>
<div class="line">{ </div>
<div class="scope">
    <div class="line"><span class="kwrd">event</span> <span class="knownType">Action</span>&lt;T&gt; OnNext; </div>
</div>
<div class="line">} </div>
</div>
        <p>
        When we convert the observable sequence with the <em>ToEvent</em> method, we can
        just subscribe by providing an <em>Action&lt;T&gt;</em>, which we do here with a
        lambda.
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">var</span> source = <span class="knownType">Observable</span>.Interval(<span class="knownType">TimeSpan</span>.FromSeconds(1))</div>
<div class="scope">
    <div class="line">.Take(5); </div>
</div>
<div class="line"><span class="kwrd">var</span> result = source.ToEvent(); </div>
<div class="line">result.OnNext += val =&gt; <span class="knownType">Console</span>.WriteLine(val);</div>
</div>
        <p>
        Output:
    </p>
        <div class="output">
          <div class="line">0</div>
          <div class="line">1</div>
          <div class="line">2</div>
          <div class="line">3</div>
          <div class="line">4</div>
        </div>
        <a name="ToEventPattern"></a>
        <h3>ToEventPattern</h3>
        <p>
        Note that this does not follow the standard pattern of events. Normally, when you
        subscribe to an event, you need to handle the <code>sender</code> and <em>EventArgs</em>
        parameters. In the example above, we just get the value. If you want to expose your
        sequence as an event that follows the standard pattern, you will need to use
        <em>ToEventPattern</em>.
    </p>
        <p>
        The <em>ToEventPattern</em> will take an <em>IObservable&lt;EventPattern&lt;TEventArgs&gt;&gt;</em>
        and convert that into an <em>IEventPatternSource&lt;TEventArgs&gt;</em>. The public
        interface for these types is quite simple.
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">public</span> <span class="kwrd">class</span> <span class="knownType">EventPattern</span>&lt;TEventArgs&gt; : <span class="knownType">IEquatable</span>&lt;<span class="knownType">EventPattern</span>&lt;TEventArgs&gt;&gt;</div>
<div class="scope">
    <div class="line">where TEventArgs : <span class="knownType">EventArgs</span> </div>
</div>
<div class="line">{ </div>
<div class="scope">
    <div class="line"><span class="kwrd">public</span> <span class="knownType">EventPattern</span>(<span class="kwrd">object</span> sender, TEventArgs e)</div>
    <div class="line">{ </div>
    <div class="scope">
        <div class="line"><span class="kwrd">this</span>.Sender = sender; </div>
        <div class="line"><span class="kwrd">this</span>.<span class="knownType">EventArgs</span> = e; </div>
    </div>
    <div class="line">} </div>
    <div class="line"><span class="kwrd">public</span> <span class="kwrd">object</span> Sender { get; <span class="kwrd">private</span> set; } </div>
    <div class="line"><span class="kwrd">public</span> TEventArgs <span class="knownType">EventArgs</span> { get; <span class="kwrd">private</span> set; } </div>
    <div class="line"><span class="rem">//...equality overloads</span></div>
</div>
<div class="line">} </div>
<div class="line"><span class="kwrd">public</span> <span class="kwrd">interface</span> <span class="knownType">IEventPatternSource</span>&lt;TEventArgs&gt; where TEventArgs : <span class="knownType">EventArgs</span></div>
<div class="line">{ </div>
<div class="scope">
    <div class="line"><span class="kwrd">event</span> <span class="knownType">EventHandler</span>&lt;TEventArgs&gt; OnNext; </div>
</div>
<div class="line">} </div>
</div>
        <p>
        These look quite easy to work with. So if we create an <em>EventArgs</em> type
        and then apply a simple transform using <em>Select</em>, we can make a standard
        sequence fit the pattern.
    </p>
        <p>
        The <em>EventArgs</em> type:
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">public</span> <span class="kwrd">class</span> MyEventArgs : <span class="knownType">EventArgs</span> </div>
<div class="line">{ </div>
<div class="scope">
    <div class="line"><span class="kwrd">private</span> <span class="kwrd">readonly</span> <span class="kwrd">long</span> _value; </div>
    <div class="line"><span class="kwrd">public</span> MyEventArgs(<span class="kwrd">long</span> value) </div>
    <div class="line">{ </div>
    <div class="scope">
        <div class="line">_value = value; </div>
    </div>
    <div class="line">} </div>
    <div class="line"><span class="kwrd">public</span> <span class="kwrd">long</span> Value </div>
    <div class="line">{ </div>
    <div class="scope">
        <div class="line">get { <span class="kwrd">return</span> _value; } </div>
    </div>
    <div class="line">} </div>
</div>
<div class="line">} </div>
</div>
        <p>
        The transform:
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">var</span> source = <span class="knownType">Observable</span>.Interval(<span class="knownType">TimeSpan</span>.FromSeconds(1))</div>
<div class="scope">
    <div class="line">.Select(i =&gt; <span class="kwrd">new</span> <span class="knownType">EventPattern</span>&lt;MyEventArgs&gt;(<span class="kwrd">this</span>, <span class="kwrd">new</span> MyEventArgs(i)));</div>
</div>
</div>
        <p>
        Now that we have a sequence that is compatible, we can use the <em>ToEventPattern</em>,
        and in turn, a standard event handler.
    </p>
        <div class="csharpcode" xmlns="">
<div class="line"><span class="kwrd">var</span> result = source.ToEventPattern(); </div>
<div class="line">result.OnNext += (sender, eventArgs) =&gt; <span class="knownType">Console</span>.WriteLine(eventArgs.Value);</div>
</div>
        <p>
        Now that we know how to get back into .NET events, let's take a break and remember
        why Rx is a better model.
    </p>
        <ul>
          <li>In C#, events have a curious interface. Some find the <code>+=</code> and <code>
            -=</code> operators an unnatural way to register a callback</li>
          <li>Events are difficult to compose</li>
          <li>Events do not offer the ability to be easily queried over time</li>
          <li>Events are a common cause of accidental memory leaks</li>
          <li>Events do not have a standard pattern for signaling completion</li>
          <li>Events provide almost no help for concurrency or multithreaded applications. For
            instance, raising an event on a separate thread requires you to do all of the plumbing</li>
        </ul>
        <hr />
        <p>
        The set of methods we have looked at in this chapter complete the circle started
        in the <a href="04_CreatingObservableSequences.html#TransitioningIntoIObservable">Creating
            a Sequence</a> chapter. We now have the means to enter and leave the observable
        sequence monad. Take care when opting in and out of the <em>IObservable&lt;T&gt;</em>
        monad. Doing so excessively can quickly make a mess of your code base, and may indicate
        a design flaw.
    </p>
        <hr />
        <div class="webonly">
          <h1 class="ignoreToc">Additional recommended reading</h1>
          <div align="center">
            <div style="display:inline-block; vertical-align: top; margin: 10px; width: 140px; font-size: 11px; text-align: center">
              <!--Domain Driven Design (Kindle) Amazon.co.uk-->
              <iframe src="http://rcm-uk.amazon.co.uk/e/cm?t=int0b-21&amp;o=2&amp;p=8&amp;l=as1&amp;asins=B00794TAUG&amp;ref=qf_sp_asin_til&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;m=amazon&amp;lc1=0000FF&amp;bc1=000000&amp;bg1=FFFFFF&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>
            </div>
            <div style="display:inline-block; vertical-align: top; margin: 10px; width: 140px; font-size: 11px; text-align: center">
              <!--Purely functional data structures Amazon.co.uk-->
              <iframe src="http://rcm-uk.amazon.co.uk/e/cm?t=int0b-21&amp;o=2&amp;p=8&amp;l=as1&amp;asins=0521663504&amp;ref=qf_sp_asin_til&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;m=amazon&amp;lc1=0000FF&amp;bc1=000000&amp;bg1=FFFFFF&amp;f=ifr" style="width:120px;height:240px;margin: 10px" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>
            </div>
            <div style="display:inline-block; vertical-align: top;  margin: 10px; width: 140px; font-size: 11px; text-align: center">
              <!--C# Linq pocket reference Amazon.co.uk-->
              <iframe src="http://rcm-uk.amazon.co.uk/e/cm?t=int0b-21&amp;o=2&amp;p=8&amp;l=as1&amp;asins=0596519249&amp;ref=qf_sp_asin_til&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;m=amazon&amp;lc1=0000FF&amp;bc1=000000&amp;bg1=FFFFFF&amp;f=ifr" style="width:120px;height:240px;margin: 10px" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>
            </div>
            <div style="display:inline-block; vertical-align: top; margin: 10px; width: 140px; font-size: 11px; text-align: center">
              <!--Real-world functional programming Amazon.co.uk-->
              <iframe src="http://rcm-uk.amazon.co.uk/e/cm?t=int0b-21&amp;o=2&amp;p=8&amp;l=as1&amp;asins=1933988924&amp;ref=qf_sp_asin_til&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;m=amazon&amp;lc1=0000FF&amp;bc1=000000&amp;bg1=FFFFFF&amp;f=ifr" style="width:120px;height:240px;margin: 10px" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>
            </div>
          </div>
        </div>
        <table width="100%">
          <tr>
            <td>&lt;&lt; Back to : <a href="09_SideEffects.html">PART 3 - Taming the sequence</a></td>
            <td></td>
            <td align="right">Moving on to : <a href="11_AdvancedErrorHandling.html">Advanced error handling</a>&gt;&gt;</td>
          </tr>
        </table>
      </div>
      <div class="footer">
            Original series @ <a href="http://leecampbell.blogspot.com/2010/08/reactive-extensions-for-net.html">Lee Campbell</a></div>
    </div>
  </body>
</html>